#### 环境配置和程序运行

- 本程序基于selenium实现数据爬取，通过xlwt和xlrd等库进行表的读写，运行需要安装相应包

  - xlwt安装：pip install xlwt
  - xlrd安装：pip install xlrd
  - xlutils安装：pip install xlutils
  - time:在原生python中就存在，无需安装
  - selenium安装：pip install selenium

- 本程序使用的浏览器驱动为chromedriver程序需要正确加载驱动方可启动

  - 驱动下载：

    ![image-20211228222410967](C:\Users\Administrator\Desktop\大三秋冬\软件质量保证与测试\说明.assets\image-20211228222410967-16407014662601.png)

    ![image-20211228222715995](C:\Users\Administrator\Desktop\大三秋冬\软件质量保证与测试\说明.assets\image-20211228222715995.png)

    如图，我的chrome浏览器是96.0.4664.110版本，所以在https://chromedriver.chromium.org/downloads网站中下载了最近的96.0.4664.45版本的浏览器驱动，我用的驱动已附，文件名为chromedriver.exe

  - 驱动安装：需要将驱动放在自己的chrome安装目录和python安装目录中

    ![image-20211228223210087](C:\Users\Administrator\Desktop\大三秋冬\软件质量保证与测试\说明.assets\image-20211228223210087.png)

    如上图，我的chromedriver.exe驱动文件放在与chrome.exe相同的文件夹中

    ![image-20211228223305105](C:\Users\Administrator\Desktop\大三秋冬\软件质量保证与测试\说明.assets\image-20211228223305105.png)

    如上图，我的chromedriver.exe驱动也放在python.exe相同的文件夹中

- 程序运行
  - 运行设置
    - 通过改变程序第11行右值引号中文件路径可以将生成的excel文件存放在本地
  - 运行参数
    - 通过改变程序第15行右值可以设置表中的最大sheet数量，具体参照重要说明第1、4条
    - 通过改变程序最后一行的run函数的参数可以设置爬取的层数，默认为2，具体参照重要说明第3条
  - 运行命令
    - 首先切换到程序所在目录，终端输入“python homework.py”即可

#### 重要说明

1. 从哔哩哔哩浙江大学主页开始，爬取投稿、频道以及关注数据，再由关注对象延伸爬取更多的用户数据，一个用户占据表中的一个sheet（存在互关时可能占据两个sheet），具体情况可以在excel表中清晰看到
2. 程序中的全局变量filepath指示输出文件存放的位置，程序员可以自行调整双引号中的绝对路径
3. 程序中run()函数使整个函数开始运行，它只需要一个参数，指示程序需要一共爬取几层数据。比如A（本程序将其固定为浙江大学）关注B、C，B关注D、E，C关注F、G，则run(2)会在excel表中和控制台中输出所有要求的相关数据，表中一共生成7个sheet，分别存储这7个节点的相关信息
4. 程序中全局变量point_num是与程序具体运行有关的量，它指定表中最多的sheet数量，表中sheet数量达到规定值后程序自动停止
5. B站用户可能存在互关情况，程序中这样设定：假如已经爬取过一个用户的信息，那么不对该用户关注列表中的用户做第二次爬取。例如A关注B，B关注C，C关注A，那么在依次爬取了A、B、C、A后不会再进行A用户关注列表中的用户的爬取
6. 存在excel表中有些数据不存在的情况，原因有两个：一是数据本身不存在（比如浙江大学的频道就是空的），二是在网页中被设置了权限（比如南方科技大学隐私设置关注列表不可见）
7. 由于selenium的限制，爬取速度不会很快，程序中我设置爬取一个用户用时大约是3秒，设置总爬取用户数量约为50，总共需要约150s，运行时请耐心等待

